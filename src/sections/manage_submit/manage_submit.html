<!DOCTYPE html>
<template class="task-template">
  <section id="manage_submit-section" class="section js-section u-category-windows">
    <header class="section-header">
      <div class="section-wrapper">
        <h1>
          <img class="section-icon" src="assets/img/manage-teal.png">
          Manage Datasets
        </h1>
        <h3>
          This interface will assist you in managing your datasets on Blackfynn: login, create datasets, add metadata, manage permissions, annotate datasets, and upload locally stored datasets.
          <br>
          <br>
        </h3>

        </h3>
      </div>
    </header>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-new-window-login-demo-toggle" class="js-container-target demo-toggle-button">Connect to your Blackfynn account
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=_HZE5rcPSMI" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Connect your Blackfynn account with SODA </div>
        </button>

        <div class="demo-box">

          <form id = 'blackfynn-account'>
            <div style = "padding:10px 0px" class="switch-field">
              <input id="addAccount" name="blackfynn-account" type="radio"/>
              <label for="addAccount" class="labelradio"> Add new account </label>
              <input id="selectAccount" name="blackfynn-account" type="radio"/>
              <label for="selectAccount" class="labelradio"> Select existing account </label>
              </div>
          </form>

          <hr>

          <div id="div-add-account" class="datasetsaveoption" style="margin-left:20px">
            <h5> Obtain API key and secret from your Blackfynn account and enter below
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Please checkout the dedicated <a href="https://help.blackfynn.com/articles/1488536-creating-an-api-key-for-the-blackfynn-clients" style="color:white;"> Blackfynn Help page</a>
                for generating API key and secret and setting up your Blackfynn account in SODA during your first use.
                </span>
              </div>
            </h5> <br>
            <div> <font color="black"> Api key name: </font> </div>
            <div class="demo-controls">
              <input id="bf-key-name" class="demo-response">
            </div> <br>
            <div> <font color="black"> Api key: </font> </div>
            <div class="demo-controls">
              <input id="bf-key" class="demo-response">
            </div> <br>
            <div> <font color="black"> Api secret: </font> </div>
            <div class="demo-controls">
              <input id="bf-secret" class="demo-response">
            </div>
            <h5> </h5>
            <div class="demo-controls">
              <button class="demo-button" id="add-bf-account"> Add Account </button>
            </div>
            <p id="para-add-account-status"></p>
          </div>

          <div id="div-select-account" class="datasetsaveoption" style="margin-left:20px">
            <h5> Select previsouly added account
             <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Previously added account(s) will be displayed in this drop-down list. Default account (last selected account before app closed) will be loaded automatically at start if available. Click on 'Switch Account' and select one from the drop-down list for changing to another account.
                </span>
              </div>
            </h5>
            <div class="demo-controls">
              <select class="my_dropdown" style="width:65%" id="bfaccountlist">
                <option> Select </option>
              </select>
              <p></p>
              <button id="button-check-bf-account-details" class="demo-button"> Switch Account </button>
            </div>

            <div id="div-bf-account-load-progress" class="progressdiv">
              <div class="indeterminatebar"></div>
            </div>
            <p id='para-select-account-status'> <p>
          </div>

        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-new-window-create-demo-toggle" class="js-container-target demo-toggle-button"> Create new empty dataset
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=6YyRmu1dbE8" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Add an empty dataset on the selected Blackfynn account </div>
        </button>
        <div class="demo-box">
          <p> </p>

          <h5> Enter name
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">Enter desired name for the new dataset</span>
            </div>
          </h5>
          <div class="demo-controls">
            <input id="bf-new-dataset-name" class="demo-response"> </input>
          </div>

          <h5> Enter subtitle (optional)
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">Add one or two sentences that explain the content of your dataset. Although optional when creating a new dataset, it is mandatory to add a subtitle before sharing your dataset with the Curation Team for review.
              <br> <br>
              It could also be added later under the "Add medatata to Blackfynn dataset" feature of SODA. </span>
            </div>
          </h5>
          <div class="demo-controls">
            <textarea id="bf-new-dataset-subtitle" class="demo-response" rows="4" maxlength="256"> </textarea>
          </div>
          <div>
            <p><span id="para-char-count"> 256 characters left </span></p>
          </div>
          <h5> </h5>
          <div class="demo-controls">
            <button id="button-create-bf-new-dataset" class="demo-button"> Create </button>
            <p id='para-add-new-dataset-status' style="margin-top:-5px"></p>
          </div>
        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-new-window-metadata-demo-toggle" class="js-container-target demo-toggle-button"> Add metadata to datasets on Blackfynn
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=uazpeqYacso" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Add subtitle, description, banner image, and license to your dataset
          </div>
        </button>
        <div class="demo-box">
          <h5> Select Blackfynn dataset
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">Select the Blackfynn dataset for which you wish to add/edit metadata (sorted alphabetically).
              <br><br>
              Subtitle, description, banner image and license are mandatory SPARC metadata.
              <br><br>
              Note: You must have "owner" or "manager" permission on the dataset to edit metadata. See feature "Manage dataset permissions" of SODA and the associated <a href="https://help.blackfynn.com/en/articles/2614125-dataset-permissions" style="color:white;"> Blackfynn Help page</a> for more information.
              </span>
            </div>
          </h5>
          <div class="demo-controls">
            <select class="my_dropdown" id="bfdatasetlist_metadata">
              <option> Select dataset </option>
            </select>
            <p></p>
            <button id="button-refresh-dataset-list-metadata" class="demo-button"> Refresh Dataset List </button>
          </div>

          <h5> </h5>
          <div id=div-bf-current-metadata-progress class="progressdiv">
            <div class="indeterminatebar"></div>
          </div>

          <form id = 'bf-add-metadata-form'>
            <div style = "padding:10px 0px" class="switch-field">
              <input id="add-edit-subtitle" name="blackfynn-add-metadata" type="radio" />
              <label for="add-edit-subtitle" class="labelradio"> Add/edit subtitle </label>

              <input id="add-edit-description" name="blackfynn-add-metadata" type="radio" />
              <label for="add-edit-description" class="labelradio"> Add/edit description </label>

              <input id="add-edit-banner" name="blackfynn-add-metadata" type="radio" />
              <label for="add-edit-banner" class="labelradio"> Upload a banner image </label>
                <!-- <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">This image will be associated with the dataset. It will be visible once the dataset is published.
                  <br>
                  <br>
                  This interface will help you make sure the uploaded image is square as per SPARC dataset requirements. Final image dimensions must be at least 1024x1024 px and 2048x2048 px is highly recommended. The final image size must not exceed 5MB as per Blackfynn's restriction.
                  </span>
                </div> -->

              <input id="add-edit-license" name="blackfynn-add-metadata" type="radio" />
              <label for="add-edit-license" class="labelradio"> Assign a license </label>

            </div>

          </form>

          <hr>

          <div id="div-add-edit-subtitle" class="datasetsaveoption">
            <h5> Enter subtitle below. Any existing subtitle will be displayed.
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">The subtitle is a short description (no more than 256 characters) that explains the content of your dataset.</span>
              </div>
            </h5>
            <div class="demo-controls">
              <textarea id="bf-dataset-subtitle" class="demo-response" rows="4" maxlength="256"> </textarea>
            </div>
            <div>
              <p><span id="para-char-count-metadata"> 256 characters left </span></p>
            </div>
            <h5> </h5>
            <div class="demo-controls">
              <button id="button-add-subtitle" class="demo-button"> Add subtitle </button>
              <p id = "para-dataset-subtitle-status"> </p>
            </div>
          </div>

          <div id="div-add-edit-description" class="datasetsaveoption">
            <h5> Enter description below. Any existing description will be displayed.
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Provide a detailed description of your dataset.
                <br>
                This description will be highly visible on the SPARC data portal once your dataset is published so it is recommended to use rich text (bold, italic, enumerated list, etc.)
                </span>
              </div>
            </h5>
            <div id="editorSection">
            </div>
            <h5> </h5>
            <div class="demo-controls">
              <button id="button-add-description" class="demo-button"> Add description </button>
              <p id = "para-dataset-description-status"> </p>
            </div>
          </div>

          <div id="div-add-edit-banner" class="datasetsaveoption">


            <h5> Add/edit banner image </h5>
            <div class="demo-controls">
              <button id="button-import-banner-image" class="demo-button"> Import image </button>
              <p id = "para-path-image"> </p>
            </div>

            <h5> </h5>
            <div class="demo-controls">
              <form>
                  <label class='input-banner-img' for='form-banner-height'>Cropped height (px):</label>
                  <input id='form-banner-height' type="text" readonly="readonly" size="7">
                  <label class='input-banner-img' for='form-banner-width'>Cropped width (px):</label>
                  <input id='form-banner-width' type="text" readonly="readonly" size="7">
              </form>
            </div>

            <h5> </h5>
            <div class="demo-controls">
              <div id= 'div-img-container' class='img-container' style="border: 1px solid black">
                <img id="image-banner" class='banner-img' width="100%" height:'auto'>
              </div>
              <div style="flex:40%">
                <div id='banner-preview' class="preview">
                </div>
              </div>
            </div>

            <h5> </h5>
            <div class="demo-controls">
              <button id="save-banner-image" class="demo-button"> Save as banner image </button>
              <p id = "para-dataset-banner-image-status"> </p>
            </div>

            <h5> Current banner image </h5>
            <div class="demo-controls">
              <img id='current-banner-img'  src=./assets/img/no-banner-image.png />
            </div>

          </div>


          <div id="div-add-edit-license" class="datasetsaveoption">

            <!-- <div class="demo-controls">
              <p id = "para-dataset-license-current"> None </p>
            </div> -->


            <div class="demo-controls">
              <div style="width: 200px; float: left;">
                <h5> Click to assign license </h5>
                <button id="button-add-license" class="demo-button" style="width: 300px"> Assign Creative Commons Attribution (CC-BY) license
                </button>
              </div>
              <div style="margin-left: 220px;">
                <h5> Current License
                </h5>
                <p id = "para-dataset-license-current"> None </p>
              </div>
              <div style="position:absolute; right:30px";>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">As per SPARC rules, you must assign the Creative Commons Attribution (CC-BY) license to your dataset.
                  </span>
                </div>
              </div>
            </div>

            <div class="demo-controls">
              <p id = "para-dataset-license-status"> </p>
            </div>

          </div>

        </div>

      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-new-window-permission-demo-toggle" class="js-container-target demo-toggle-button"> Manage dataset permissions
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=rw9pampYgqY" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Make PI owner, give access to other members or teams for collaborating, , share with the Curation Team for review  </div>
        </button>
        <div class="demo-box">
          <h5> Select Blackfynn dataset
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">Select the Blackfynn dataset you wish to see/edit permissions (sorted alphabetically)
              <br><br>
              Note: You must have "owner" or "manager" permission on the dataset to manage permissions. See the associated <a href="https://help.blackfynn.com/en/articles/2614125-dataset-permissions" style="color:white;"> Blackfynn Help page</a> for more information.
              </span>
            </div>
          </h5>
          <div class="demo-controls">
            <select class="my_dropdown" id="bfdatasetlist_permission">
              <option> Select dataset </option>
            </select>
            <p></p>
            <button id="button-refresh-dataset-list-permission" class="demo-button"> Refresh Dataset List </button>
          </div>
          <h5> Current permission
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">Name of user (First name, Last name) and their current permission ('owner', 'viewer', 'manager', or 'editor') will be shown here for the selected dataset</span>
            </div>
          </h5>
          <div id=div-bf-current-permission-progress class="progressdiv">
            <div class="indeterminatebar"></div>
          </div>
          <div class="demo-controls">

            <p id = "para-dataset-permission-current"> None </p>
          </div>


          <h5> Change permissions
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">
              SPARC curation rules require to set the PI of the SPARC award as "owner" of the dataset before it is shared with the Curation Team for review.
              <br>
              <br>
              Giving permissions to other members and/or team is only necessary if you need them to make changes to the dataset.
              <br>
              <br>
              Sharing with the SPARC Curation Team will assign them "manager" role, which is necessary for them to access and review your dataset.
              </span>
            </div>
          </h5>

          <form id = 'blackfynn-permission-form'>
            <div style = "padding:10px 0px" class="switch-field">
              <input id="pi-owner" name="blackfynn-permission-sharing" type="radio"/>
              <label for="pi-owner" class="labelradio"> Make PI owner of dataset</label>

              <input id="user-permission" name="blackfynn-permission-sharing" type="radio"/>
              <label for="user-permission" class="labelradio"> Add/edit member permissions  </label>

              <input id="team-permission" name="blackfynn-permission-sharing" type="radio"/>
              <label for="team-permission" class="labelradio"> Add/edit team permissions </label>

              <input id="curation-team" name="blackfynn-permission-sharing" type="radio"/>
              <label for="curation-team" class="labelradio"> Share with Curation Team </label>

            </div>
          </form>

          <hr>

          <div id="div-bf-pi-owner" class="datasetsaveoption">
              <h5>
              </h5>
              <div class="demo-controls">
                <select class="my_dropdown" id="bf_list_users_pi">
                  <option> Select PI </option>
                </select>
              </div>

              <h5>  </h5>
              <div class="demo-controls">
                <button id="button-add-permission-pi" class="demo-button" style="width: 250px"> Make PI owner </button>
                <p id = "para-dataset-permission-status-pi"> </p>
              </div>
          </div>

          <div id="div-bf-share-curation-team" class="datasetsaveoption">
              <h5>
              </h5>
              <h5>  </h5>
              <div class="demo-controls">
                <button id="button-add-permission-curation-team" class="demo-button" style="min-width: 250px"> Share with Curation Team </button>
                <p id = "para-dataset-permission-status-curation-team"> </p>
              </div>
          </div>

          <div id="div-bf-user-permission" class="datasetsaveoption">
              <h5>
              </h5>
              <div class="demo-controls">
                <select class="my_dropdown" id="bf_list_users">
                  <option> Select user </option>
                </select>
              </div>

              <h5>  </h5>
              <div class="demo-controls">
                <select class="my_dropdown" id="bf_list_roles">
                  <option> Select role </option>
                  <option> viewer </option>
                  <option> manager </option>
                  <option> editor </option>
                  <option> owner </option>
                  <option> remove current permission </option>
                </select>
              </div>

              <h5>  </h5>
              <div class="demo-controls">
                <button id="button-add-permission" class="demo-button" style="width: 250px"> Add permission for user </button>
                <p id = "para-dataset-permission-status"> </p>
              </div>
          </div>

          <div id="div-bf-team-permission" class="datasetsaveoption">
            <h5>
            </h5>
            <div class="demo-controls">
              <select class="my_dropdown" id="bf_list_teams">
                <option> Select team </option>
              </select>
            </div>

            <h5>  </h5>
            <div class="demo-controls">
              <select class="my_dropdown" id="bf_list_roles_team">
                <option> Select role </option>
                <option> viewer </option>
                <option> manager </option>
                <option> editor </option>
                <option> remove current permission </option>
              </select>
            </div>

            <h5>  </h5>
            <div class="demo-controls">
              <button id="button-add-permission-team" class="demo-button" style="width: 250px"> Add permission for team </button>
              <p id = "para-dataset-permission-status-team"> </p>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-new-window-annotate-demo-toggle" class="js-container-target demo-toggle-button"> Annotate dataset
         <!--  <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=T_AHgEUXFAA&feature=youtu.be" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a> -->
          <div class="demo-meta u-avoid-clicks"> Inform the model properties for your dataset </div>
        </button>
        <div class="demo-box">
          <p> </p>

          <p> Coming soon... Tentative date: April 2020</p>

        </div>
      </div>
    </div>



    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-new-window-submit-demo-toggle" class="js-container-target demo-toggle-button"> Upload local dataset
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=rtoLtpw6e-A" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Upload a locally stored dataset to a Blackfynn dataset </div>
        </button>
        <div class="demo-box">
          <p> </p>

          <h5> Select local dataset to submit
<!--           <div class="tooltipnew"><img class="info" src="assets/img/info.png">
            <span class="tooltiptext">Select the local folder that you want to submit to your Blackfynn account</span>
          </div> -->
          </h5>
          <div class="demo-controls">
            <button id="button-select-submit-dataset" class="demo-button">Select Folder </button>
            <textarea class="demo-response-upload" style="resize: none; height:45px;" id="selected-submit-dataset"></textarea>
          </div>

          <h5> Select Blackfynn dataset for uploading
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">
              Note: You must have "owner", "manager" or "editor permission on the dataset to upload. See feature "Manage dataset permissions" of SODA and the associated <a href="https://help.blackfynn.com/en/articles/2614125-dataset-permissions" style="color:white;"> Blackfynn Help page</a> for more information.
              </span>
            </div>
          </h5>
          <div class="demo-controls">
            <select class="my_dropdown" id="bfdatasetlist">
              <option> Select dataset </option>
            </select>
            <p></p>
            <button id="button-refresh-dataset-list" class="demo-button"> Refresh Dataset List </button>
          </div>

          <h5> </h5>
          <!-- <div class="demo-controls">
            <button id="button-refresh-dataset-list" class="demo-button"> Refresh dataset list </button>
          </div> -->

          <div>
            <h5> Upload
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">
                Click on 'Submit dataset' to push all the files/folders from the selected local folder into the selected Blackfynn dataset. Local folder structure will be preserved. The progress bar located below will provide a live update on the upload.
                </span>
              </div>
            </h5>
            <div>
            <button id="button-submit-dataset" class="demo-button"> Submit dataset </button>
            <p id='para-please-wait-manage-dataset'></p>
            </div>
            <p id='para-progress-bar-error-status'> <p>
            <div id="div-progress-submit">
            <h5> Progress </h5>
            <progress class=progresstrack id=progress-bar-upload-bf max="100" value="0"></progress>
            <p id='para-progress-bar-status'> <p>
            </div>
          </div>
        </div>
      </div>
    </div>


    <script type="text/javascript">
      require('./renderer-process/native-ui/dialogs/open-file')
      require('./renderer-process/native-ui/dialogs/save')
      require('./renderer-process/manage_submit/blackfynn_account')
    </script>

    <script src="node_modules/cropperjs/dist/cropper.js"></script>

    <script src="node_modules/jquery/dist/jquery.js"></script>
    <script>window.$ = window.jQuery = require('jquery');</script>

    <script src='node_modules/markdown-it/dist/markdown-it.js'></script>
    <script src="node_modules/to-mark/dist/to-mark.js"></script>
    <script src="node_modules/tui-code-snippet/dist/tui-code-snippet.js"></script>
    <script src="node_modules/tui-color-picker/dist/tui-color-picker.js"></script>
    <script src="node_modules/codemirror/lib/codemirror.js"></script>
    <script src="node_modules/highlight.js/lib/highlight.js"></script>
    <script src="node_modules/squire-rte/build/squire-raw.js"></script>
<!--     <script src="node_modules/tui-editor/dist/tui-editor-Editor.js"></script> -->
    <script src="node_modules/tui-editor/dist/tui-editor-Editor-all.min.js"></script>

  </section>
</template>
