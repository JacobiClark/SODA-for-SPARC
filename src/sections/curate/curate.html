<template class="task-template">
  <section id="curate-section" class="section js-section u-category-windows">

    <header class="section-header">
      <div class="section-wrapper">
        <h1>
          <img class="section-icon" src="assets/img/dataset-teal.png">
          Prepare Dataset
        </h1>
        <h3>This interface will walk you through the steps for performing an initial curation of your dataset before review by the Curation Team. Specify successively your requirements, validate, and finally generate your SPARC dataset.
        </h3>
      </div>
    </header>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-specfy-dataset-demo-toggle" class="js-container-target demo-toggle-button"> Specify dataset files
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=WDvH8dIcsBA">
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Specify desired local files to be added in each of the SPARC folders of your dataset
          </div>
        </button>
        <div id="div-specify-dataset-files" class="demo-box">

          <div style="display:none">
          <form id = 'form-dataset-organize-form'>
            <div style = "padding:10px 0px" class="switch-field">

              <input id="organize-dataset" name="organizing-dataset" type="radio" checked/>
              <label for="organize-dataset" class="labelradio"> Organize my dataset </label>
                <!-- <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">Select this option to conveniently organize your dataset following the SPARC folder structure
                  </span>
                </div> -->

              <input id="preorganized-dataset" name="organizing-dataset" type="radio"/>
              <label for="preorganized-dataset" class="labelradio"> Dataset already organized </label>
                <!-- <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">Select this option when you already have the SPARC folder structure in place and you only want, e.g., to add description, include metadata files, and/or validate your dataset
                  </span>
                </div> -->

            </div>
          </form>
          </div>

          <div id="div-pre-organized-dataset" class="datasetsaveoption">
            <h5> </h5>
            <div class="demo-controls">
                  <table id="table-organized" class = "pathtable">
                    <tr class="parent" id='code_org'>
                      <th class="table-header">code</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id='derivatives_org'>
                      <th class="table-header">derivatives</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id='docs_org'>
                      <th class="table-header">docs</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id='primary_org'>
                      <th class="table-header">primary</th>
                      <th>description</th>
                    </tr>

                    <tr class="parent" id="protocol_org">
                    <th class="table-header">protocol</th>
                    <th>description</th>
                    </tr>

                    <tr class="parent" id='source_org'>
                      <th class="table-header">source</th>
                      <th>description</th>
                    </tr>

                  </table>
              </div>
              <h5> </h5>
              <div class="demo-controls">
                <button id="button-select-dataset" class="demo-button"> Select Dataset Folder </button>
                <p id="para-selected-dataset" style="margin-top:-5px"></p>
              </div>
          </div>

          <div id="div-organize-dataset" class="datasetsaveoption">
            <h5> Specify files/folders to be included in each SPARC folder.
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">
                  Files are organized in SODA by adding them in the table under the desired header (corresponding to a SPARC folder). This table will then be used by the program to create your dataset when you reach the "Generate dataset" step.
                  <br><br>
                  Select SPARC folder from the drop-down list then add files/folders in the table using the corresponding buttons. Alternatively, you could drag/drop files/folders from your computer on the table headers to import them.
                  <br><br>
                  You can then add a description for the file, which will be included in the corresponding manifest file if generated with SODA.
                  <br><br>
                  If a folder is added, only the path of the selected folder will be displayed in the table but all sub-folders and files will be included when the dataset is generated.
                </span>
              </div>
            <br>
            Their paths will be added under the corresponding table header.
            </h5>
            <p></p>

            <h5>
                <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                  <span class="tooltiptext">
                  Save: Save the table you created in a CSV format file for continuing later.
                  <br><br>
                  Import: Import progress file you saved previously and continue organizing your dataset.
                  <br><br>
                  Preview: Get a preview of the dataset that will be generated based on the tables. The preview is created in a folder named 'Preview' and located in a 'SODA' folder on the user's computer. The files in the preview are mock files (0 kb) with only name and extension corresponding to the actual files specified in the tables under 'Specify dataset files' and 'Speficy metadata files' features.
                  </span>
                </div>
              </h5>

            <div class="demo-controls">
              <button id="button-select-upload-file-organization" class="demo-button"> Import Table </button>
              <button id="button-select-save-file-organization"class="demo-button"> Save Table </button>
              <button id="button-preview-file-organization" class="demo-button"> Preview </button>
              <button id="button-clear-table" class="demo-button"> Clear Table </button>
            </div>

            <p id='para-save-file-organization-status'> <p>


            <div class="demo-controls">
                <table id="code_table" class = "pathtable">
                  <tr class="parent" id="code" droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">code</th>
                    <th>
                      <button id="button-drop-code" class="demo-button-table drag">Drag & drop here </button>
                      <button id="button-select-code" class="demo-button-table">Select files </button>
                      <button id="button-select-code-directory" class="demo-button-table">Select folders</button>
                    </th>
                  </tr>

                  <tr class="parent" id='derivatives' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">derivatives</th>
                    <th>
                      <button id="button-drop-derivatives" class="demo-button-table drag">Drag & drop here </button>
                      <button id="button-select-derivatives" class="demo-button-table">Select files </button>
                      <button id="button-select-derivatives-directory" class="demo-button-table">Select folders</button>
                    </th>
                  </tr>

                  <tr class="parent" id='docs' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">docs</th>
                    <th>
                      <button id="button-drop-docs" class="demo-button-table drag">Drag & drop here </button>
                      <button id="button-select-docs" class="demo-button-table">Select files </button>
                      <button id="button-select-docs-directory" class="demo-button-table">Select folders</button>
                    </th>
                  </tr>

                  <tr class="parent" id='primary' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">primary</th>
                    <th>
                      <button id="button-drop-primary" class="demo-button-table drag">Drag & drop here </button>
                      <button id="button-select-primary" class="demo-button-table">Select files </button>
                      <button id="button-select-primary-directory" class="demo-button-table">Select folders</button>
                    </th>
                  </tr>

                  <tr class="parent" id="protocol" droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">protocol</th>
                    <th>
                      <button id="button-drop-protocol" class="demo-button-table drag">Drag & drop here </button>
                      <button id="button-select-protocol" class="demo-button-table">Select files </button>
                      <button id="button-select-protocol-directory" class="demo-button-table">Select folders</button>
                    </th>
                  </tr>

                  <tr class="parent" id='source' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                    <th class="table-header">source</th>
                    <th>
                      <button id="button-drop-source" class="demo-button-table drag">Drag & drop here </button>
                      <button id="button-select-source" class="demo-button-table">Select files </button>
                      <button id="button-select-source-directory" class="demo-button-table">Select folders</button>
                    </th>
                  </tr>
                </table>
            </div>



          </div>

          <div id="div-save-table" class="datasetsaveoption">
          </div>

          <div id="div-smart-organize" class="datasetsaveoption" style="display:none">
            <hr>
            <h5> Smart Organize </h5>
            <p>Coming soon... Tentative date: February 2020</p>
          </div>

          <div id="div-clear-table" class="datasetsaveoption">
          </div>

          <div id="div-organize-next-step" align="right">
            <br><br>
            <button id="button-organize-next-step" class="demo-button-next-step"> Next step </button>
          </div>

        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-file-conversion-demo-toggle" class="js-container-target demo-toggle-button"> Handle file format conversion
         <!--  <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=T_AHgEUXFAA&feature=youtu.be" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a> -->
          <div class="demo-meta u-avoid-clicks"> Choose files to be converted to SPARC defined standard formats before generating your dataset  </div>
        </button>
        <div id="div-file-conversion" class="demo-box">
          <p> Coming soon... Tentative date: May 2020 </p>
          <div id="div-file-conversion-next-step" align="right">
            <h5> </h5>
            <button id="button-file-conversion-next-step" class="demo-button-next-step"> Next step </button>
          </div>
        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-specify-metadata-demo-toggle" class="js-container-target demo-toggle-button">
        Specify metadata files
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=ncrR7NV4YnU">
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Choose metadata files to be included in your dataset </div>
        </button>
        <div id="div-specify-metadata" class="demo-box">

          <h5>Manifest files
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">
              Select this option to include a manifest file in each of the high-level SPARC folder.
              <br><br>
              The 'filename', 'timestamp', and 'file type' fields will be populated automatically while 'description' will be populated with descriptions (if any) added in the table under the 'Specify dataset files' feature.
              <br><br>
              Note: If this option is selected, any manifest files specified in the table under the 'Specify dataset files' feature will be ignored when the dataset is generated.
              </span>
            </div>
          </h5>

          <h5></h5>
          <div class="demo-controls">
            <label class="switch">
              <input id="generate-manifest" name="manifest" type="checkbox" class="with-style-manifest" onclick="updateManifestLabelColor(this)"/>
              <span class="slider round"></span>
            </label>
            <label id="label-manifest" class="labelradio-manifest" style="padding-left:10px"> Include auto-generated manifest files
            </label>
          </div>

          <p></p>
          <h5>High-level metadata files (submission, dataset_description, etc.)
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">
              These files will be included in the main folder of your dataset.
              <br><br>
              The submission and dataset_description files are mandatory for all datasets.
              <br><br>
              Requirement of samples and/or subjects files is dataset-specific.
              <br><br>
              All these files must be in xlsx or cvs formats. Visit the "Prepare Metadata" section of SODA to download templates of these files provided by the Curation Team.
              </span>
            </div>
          </h5>
            <table id="metadata-table" class = "pathtable">
              <tr class="parent" id='metadata' droppable="true" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)" ondragover="return false">
                <th class="table-header">metadata files</th>
                <th>
                  <button id="button-drop-metadata" class="demo-button-table drag">Drag & drop here </button>
                  <button id="button-select-metadata" class="demo-button-table">Select files </button>
                </th>
              </tr>
            </table>

          <p></p>
          <h5> Preview how your dataset will look once generated
            <div class="tooltipnew"><img class="info" src="assets/img/info.png">
              <span class="tooltiptext">
              The preview is created in a folder named 'Preview' and located in a 'SODA' folder on the user's computer. The files in the preview are mock files (0 kb) with only name and extension corresponding to the actual files specified in the tables under 'Specify dataset files' and 'Speficy metadata files' features.
              </span>
            </div>
          </h5>
          <div class="demo-controls">
              <button id="button-preview-file-organization-metadata" class="demo-button"> Preview</button>
              <p id='para-preview-organization-status-metadata'> <p>
          </div><br>

          <div id="div-specify-metadata-next-step" align="right">
            <h5> </h5>
            <button id="button-specify-metadata-next-step" class="demo-button-next-step"> Next step </button>
          </div>
        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-validate-dataset-demo-toggle" class="js-container-target demo-toggle-button"> Validate dataset before generating
          <!-- <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=T_AHgEUXFAA&feature=youtu.be" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a> -->
          <div class="demo-meta u-avoid-clicks"> Check that information provided during the previous steps will create a SPARC-approved dataset. Note: this is only a preliminary check before a thorough check by the Curation Team. </div>
        </button>
        <div id="div-validate-dataset" class="demo-box">
          <p> Coming soon... Tentative date: February 2020 </p>
          <div id="div-validate-dataset-next-step" align="right">
            <h5> </h5>
            <button id="button-validate-dataset-next-step" class="demo-button-next-step"> Next step </button>
          </div>
        </div>
      </div>
    </div>

    <div class="demo">
      <div class="demo-wrapper">
        <button id="button-generate-dataset-demo-toggle" class="js-container-target demo-toggle-button"> Generate dataset
          <a style="padding:0px 0px 0px 10px" href="https://www.youtube.com/watch?v=zXxOYhuFTJQ" >
            <img class="nav-video" src="assets/img/play-video-icon.png">
          </a>
          <div class="demo-meta u-avoid-clicks"> Create dataset based on information specified during the previous steps (dataset could be created locally or pushed directly to Blackfynn </div>
        </button>

        <div id="div-generate-dataset" class="demo-box">

          <div id = "div-existing-dataset" style="display:none">
            <input id="existing-dataset" name="newdataset" type="radio" class="with-style" />
            <label id = "label-existing-dataset" for="existing-dataset" class=labelradio> Modify current dataset</label>
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">This will add all changes to the current dataset folder.
                <br>
                This option will only be available when 'Dataset already organized' option is selected.
              </div>
          </div>

          <form id = 'dataset-curate-form'>
            <div style = "padding:10px 0px" class="switch-field">

              <input id="create-newdataset" name="newdataset" type="radio"/>
              <label for="create-newdataset" class=labelradio>Create new dataset on computer</label>

              <input id="cloud-dataset" name="newdataset" type="radio"/>
              <label for="cloud-dataset" class="labelradio">Create new dataset directly on Blackfynn</label>

            </div>
          </form>

          <hr>

          <div id="div-create-new" class="datasetsaveoption">

            <h5> Select destination folder for new dataset </h5>
            <div class="demo-controls">
              <button id="button-select-new-dataset" class="demo-button"> Select Destination </button>
              <textarea class="demo-response" id="selected-new-dataset"></textarea>
            </div>

            <h5> Enter a name for the new dataset  </h5>
              <div class="demo-controls">
                <textarea class="demo-response" id="new-dataset-name"></textarea>
              </div>

          </div>

          <div id="div-create-cloud" class="datasetsaveoption">
            <h5> </h5>
            <!-- <button id="button-upload-check-bf-account-details" class="demo-button"> Load existing account(s) </button> -->
            <h5> Select account </h5>
            <div class="demo-controls">
              <select id="bfuploadaccountlist" class="my_dropdown">
                <option> Select </option>
              </select>
              <p id="para-account-details"></p>
              <button id="button-upload-check-bf-account-details" class="demo-button"> Switch account </button>
            </div>

            <div id=div-bf-account-load-progress-curate class="progressdiv">
              <div class="indeterminatebar"></div>
            </div>
            <p id='para-upload-select-account-status'> <p>


            <h5> Select Blackfynn dataset for uploading
              <div class="tooltipnew"><img class="info" src="assets/img/info.png">
                <span class="tooltiptext">Select the target dataset on your Blackfynn account (sorted alphabetically)
                <br> <br>
                Note: You must have "owner", "manager" or "editor permission on the dataset to upload. See feature "Manage dataset permissions" of SODA and the associated <a href="https://help.blackfynn.com/en/articles/2614125-dataset-permissions" style="color:red;"> Blackfynn Help page</a> for more information.
                </span>
              </div>
            </h5>
            <div class="demo-controls">
              <select class="my_dropdown" id="bfuploaddatasetlist">
                <option> Select dataset </option>
              </select>
              <p></p>
              <button id="button-upload-refresh-dataset-list" class="demo-button"> Refresh dataset list </button>
            </div>
          </div>

          <p> </p>

          <div id="div-curate-button" class="datasetsaveoption">

            <h5> Proceed </h5>
            <button id="button-curate-dataset" class="demo-button"> Generate </button>
            <p id="para-please-wait-curate"</p>
          </div>

          <div id="div-curate-progress-bar-error-status" class="datasetsaveoption">
            <p id='para-curate-progress-bar-error-status'> <p>
          </div>

          <div id="div-curate-progress">
          <div id="div-curate-meter-progress" class="datasetsaveoption">
            <h5> Progress </h5>
            <progress class=progresstrack id="progress-bar-curate" max="100" value="0"></progress>
          </div>
          <div id="div-curate-progress-bar-status" class="datasetsaveoption">
            <p id='para-curate-progress-bar-status'> <p>
          </div>
          </div>

        </div>
      </div>
    </div>

    <script type="text/javascript">
      require('./renderer-process/curate/radio-buttons-display')
    </script>

    <script type="text/javascript" src="./renderer-process/curate/table-script.js">
    </script>

    <script type="text/javascript">
    //Manifest file label color change if checked
      function updateManifestLabelColor(el){
        document.getElementById('label-manifest').style.color = el.checked ? "inherit" : "#303030"
        document.getElementById('label-manifest').style.fontWeight = el.checked ? "bold": "normal"
        document.getElementById('label-manifest').style.fontSize = el.checked ? "1.1em": "1em"
      }
    </script>

  </section>
</template>
